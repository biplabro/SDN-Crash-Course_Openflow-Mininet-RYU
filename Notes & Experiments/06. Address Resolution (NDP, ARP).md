# Address Resolution (NDP, ARP)
This article ia a brief introduction of *Neighbour Discovery Protocol(NDP)*, more specifically *Addredd Resolution Protocol(ARP)* & a simple Demo of ARP using **mininet**.

## 1. Neighbour Discovery Protocol (NDP)

Similar to IPv4's ARP, IPv6's NDP is used to discover the Link Layer Address (MAC) of available Hosts or connection information of available Routers.

IPv6 Neighbor Discovery (ND) is a set of messages and processes defined in [RFC 4861](https://tools.ietf.org/html/rfc4861) that determine relationships between neighboring nodes. ND replaces Address Resolution Protocol (ARP), Internet Control Message Protocol (ICMP) router discovery, and the ICMP Redirect message used in IPv4. NDP performs at the Link Layer of OSI model performing the following major activities on the IPv6 local link: [1]

* **Router discovery –** Aids hosts in locating routers on the local link.

* **Address autoconfiguration –** Enables a node to automatically configure IPv6 addresses for its interfaces.

* **Prefix discovery –** Enables nodes to discover the known subnet prefixes that have been allocated to a link. Nodes use prefixes to distinguish destinations that are on the local link from those destinations that are only reachable through a router.

* **Address resolution –** Helps nodes to determine the link-local address of a neighbor, given only the destinations's IP address.

* **Next-hop determination –** Uses an algorithm to determine the IP address of a packet recipient one hop that is beyond the local link. The next-hop can be a router or the destination node.

* **Neighbor unreachability detection –** Aids nodes to determine if a neighbor is no longer reachable. For both routers and hosts, address resolution can be repeated.

* **Duplicate address detection –** Enables a node to determine if an address that the node wants to use is not already in use.

* **Redirection –** Enables a router to inform a host of a better first-hop node to use to reach a particular destination.

NDP uses Internet Control Message Protocol version6 **(ICMPv6) which is an integral part of IPv6**. ICMPv6 is used by IPv6 nodes to **report error messages and perform informational functions**. [2]

### 1.1 NDP ICMPv6 packet types

NDP includes 5 types of ICMPv6 packets.

    1. Router Solicitation (RS)
    2. Router Advertisement (RA)
    3. Neighbour Solicitation (NS)
    4. Neighbour Advertisement (NA)
    5. Redirect Message (RM)

#### 1.1.1 Router Solicitation (ICMPv6 type 133)

When a computer wants to connect to a network, it transmits **all-router multicast request** to locate routers in the local link. It requests the network to provide router addressing information. This message is called RS. 

![Fig.1: Router Solicitation](https://github.com/biplabro/SDN-hands-on_Openflow-Mininet-RYU/blob/master/images/Router%20Solicitation.jpg)

Fig.1: Router Solicitation

RS message includes two types of information **RS Header** & **RS Data**.

#### 1.1.2 Router Advertisement (ICMPv6 type 134)

In response to RS, all the routers in the network send **all-node multicast packet**. This packet is called RA.

![Fig.2: Router Advertisement](https://github.com/biplabro/SDN-hands-on_Openflow-Mininet-RYU/blob/master/images/Router%20Advertisement.jpg)

Fig.2: Router Advertisement

RA packet includes two types of information **RA Header** & **RA Data**. Practically. every router multicasts RA message to every node periodically. Whenever a new node is added to the network, the router sends RA signal to the node immediately without waiting for the next schedule.  

#### 1.1.3 Neighbour Solicitation (ICMPv6 type 135)

NS is used by the nodes in a network to **determine the (MAC)** link layer address of a neighbour or to verify **if the neighbour is still reachable**. 

![Fig.3: Neighbour Solicitation](https://github.com/biplabro/SDN-hands-on_Openflow-Mininet-RYU/blob/master/images/Neighbour%20Solicitation.jpg)

Fig.3: Neighbour Solicitation

#### 1.1.4 Neighbour Advertisement (ICMPv6 type 136)

NA message includes the MAC address of the **neighbouring nodes**.

![Fig.4: Neighbour Advertisement](https://github.com/biplabro/SDN-hands-on_Openflow-Mininet-RYU/blob/master/images/Neighbour%20Advertisement.jpg)

Fig.4: Neighbour Advertisement

#### 1.1.5 Redirect Message (ICMPv6 type 137)

A router sends redirect message to **inform a host of better first-hop node** on the path to a destination. The better first-hop could be a different router or the destination itself.

![Fig.5: Redirect Mesage](https://github.com/biplabro/SDN-hands-on_Openflow-Mininet-RYU/blob/master/images/Redirect%20Message.jpg)

Fig.5: Redirect Mesage

**SUMMARY:** NDP uses ICMPv6 messages & solicited-node multicast addresses to find the link layer address of a neighbour on a local network.














### _References_

```
[1] https://docs.oracle.com/cd/E23823_01/html/816-4554/chapter1-40.html
[2] https://www.youtube.com/watch?v=a1AQfjWwPaE
[3] 
[4] 
[5] 
[6] 
[7] 
[8] 
[9] 
[10] 
[11] 
[12] 
[13] 
[14] 
[15] 
[16] 
```
